import pandas as pd
from pptx import Presentation
from pptx.util import Inches

# Read data from Excel
excel_file = "data.xlsx"
sheet_name = "Sheet1"  # Change if necessary
df = pd.read_excel(excel_file, sheet_name=sheet_name)

# Open the PowerPoint presentation
prs = Presentation("template.pptx")

# Get slide 7 (index 6)
slide = prs.slides[6]

# Determine table dimensions: add one row for headers
rows = df.shape[0] + 1
cols = df.shape[1]

# Define table position and size (adjust these values as needed)
left = Inches(1)
top = Inches(2)
width = Inches(8)
height = Inches(0.8 * rows)  # approximate height per row

# Add table shape to the slide
table_shape = slide.shapes.add_table(rows, cols, left, top, width, height)
table = table_shape.table

# Fill the header row
for col_index, col_name in enumerate(df.columns):
    table.cell(0, col_index).text = str(col_name)

# Fill in the data rows
for i, row in df.iterrows():
    for j, value in enumerate(row):
        table.cell(i+1, j).text = str(value)

# Save the updated presentation
prs.save("output.pptx")