from TM1py.Services import TM1Service
from TM1py.Exceptions import TM1pyException
import logging

logging.basicConfig(level=logging.DEBUG)

ADDRESS = "epmtm1.fg.rbc.com"
PORT = 5001              # Confirm this REST API port with your admin
INSTANCE = "WM"          # The TM1 instance you log into
NAMESPACE = "palm"       # Your confirmed namespace
USERNAME = "3600700957"  # Your username (as you showed earlier)
PASSWORD = "Northern0"   # Your password (as you showed earlier)

try:
    with TM1Service(
        address=ADDRESS,
        port=PORT,
        ssl=True,                 # Likely True if you're using HTTPS
        user=USERNAME,
        password=PASSWORD,
        namespace=NAMESPACE,
        gateway=INSTANCE,         # Important: specify the instance (gateway)
        verify=True
    ) as tm1:
        cubes = tm1.cubes.get_all_names()
        print("Connected successfully! Cubes:", cubes)

except TM1pyException as e:
    print(f"TM1PyException: {e}")

except Exception as e:
    print(f"Unexpected error: {e}")